<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"><!--эта строка нужна для того, чтобы браузер не угадывал кодировку-->
  <title>
    Оптимальный центр
  </title>
  <style>
  </style>
</head>
<body>
	<div class="container">
	<input type="file" id="files" accept="text/*" multiple/>
	<p>	Найти нулевой пункт, в котором сумма за перевозку </p>
	<p>будет минимальной, если цена за перевозку равняется </p>
	<p>3 * расстояние от нулевого пункта (км) *</p>
	<p>количество мусора в этом пункте сбора мусора. </p>
	</div>
	<style>
	.container {
		height: 400px;
		width: 600px;
		background-color: orange;
		display: flex;
		justify-content: center;
		justify-self: center;
		align-items: center;
		align-self: center;
		margin-top: 100px;
		flex-direction: column;
		font-size: 20px;
	}
	.container p {color: #ffffff;}
	</style>
  <script>
  
  "use strict";
  
	let points = [],
		right_sum=0,
		left_sum=0,
		right_sum_without=0,
		left_sum_without=0,
		sum, current_sum, min_el, edge_el_left;
	
	function printFiles(e) {
	
			const files = e.target.files;
			for (let file of files) {
			
				const reader = new FileReader();
				
				reader.onload = () => {
				
					console.log(reader.result);
					
					points = reader.result.split('\n').map(element => parseInt(element));
					//alert(points);
					let count = points.shift();
					
					let center_el_id = (Math.ceil(points.length / 2));
					
					
					for (let i = 1; i <= center_el_id; i++) {
					
						right_sum += points[i]*i;
						
						//alert(`${points[i]} ${points[count - i]} `);
						
						if (i > 1) right_sum_without += points[i];
						
						if ( i < center_el_id ) {
						
						left_sum += points[count - i]*i;
						
						left_sum_without += points[count - i];
						//alert(`${points[i]} ${points[count - i]} `);
							}
						}
				
					sum = right_sum + left_sum; 
					
					
					// обход идёт по часовой стрелке
					// сумма левой и правой части обновляется на каждом шаге
					// вычитается следующий элемент и добавляется нулевой пункт для текущей суммы
					for (let i = 0; i < count; i++) {
					
						//console.log(`i: ${i}, мин. сумма: ${sum} левая сумма: 
						${left_sum_without} правая сумма: ${right_sum_without}`);
						
					
						edge_el_left = (center_el_id + i+1) - count;
						
						if ( (center_el_id + i+1) < count) edge_el_left = (center_el_id + i+1);
						
						//console.log(` прошлая сумма ${current_sum} ${edge_el_left} ${points[edge_el_left]}`);
						if (i === points.length-1) {
						
						
							current_sum =
								( sum + points[i] - points[0] ) + 
									left_sum_without -
										right_sum_without;
									
							if (current_sum < sum) {min_el = i;
								sum = current_sum; }
								
							
							//console.log(` текущая сумма ${current_sum} ${edge_el_left} ${points[edge_el_left]}`);
							continue;
							
						}// когда последний, чтобы не выйти за предел
						
					
						current_sum = 
							( sum + points[i] - points[i + 1] ) + 
								left_sum_without -
									right_sum_without;
						
						//alert(`${edge_el_left} ${points[edge_el_left]}`);
						
						left_sum_without = left_sum_without 
							+ points[i] 
								- points[edge_el_left];
								
						right_sum_without = right_sum_without
							+ points[edge_el_left] // center_el_id + i+1
								- points[i];
								
						if (current_sum < sum) {min_el = i;
							sum = current_sum; }
							
							
						//console.log(` текущая сумма ${current_sum} ${edge_el_left} ${points[edge_el_left]}`);
						//console.log(`сумма ${sum}, элемент i ${points[i]} эл edge_el_left ${points[edge_el_left]} i+1 ${points[i + 1]} edge_el_left: ${edge_el_left} center_el_id + i+1 ${center_el_id + i + 1}`);

							
					}
		//471228
		// 49113954961677
		alert(`Минимальная сумма равна ${sum*3}, это пункт \u{2116} ${min_el+1} !`); // расстояние между пунктами 3 км
	};
		reader.readAsText(file);
   }
}
document.getElementById("files").addEventListener("change", printFiles);
	
  </script>
</body>
</html>